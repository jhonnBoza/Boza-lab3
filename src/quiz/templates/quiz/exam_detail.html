{% extends "base.html" %}

{% block title %}{{ exam.title }}{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h1>{{ exam.title }}</h1>
        <p>{{ exam.description }}</p>
    </div>
    <div class="col-md-4 text-end">
        {% if user.is_authenticated and questions %}
            <a href="{% url 'take_exam' exam.id %}" class="btn btn-success me-2">
                üéØ Take Exam
            </a>
        {% endif %}
        {% if user.is_authenticated %}
            <a href="{% url 'question_create' exam.id %}" class="btn btn-primary">
                ‚ûï Add Question
            </a>
        {% endif %}
    </div>
</div>

<div class="mb-4">
    <h2>üìù Questions</h2>
    {% if questions %}
        <div class="accordion" id="accordionQuestions">
            {% for question in questions %}
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" 
                            data-bs-toggle="collapse" 
                            data-bs-target="#collapse{{ question.id }}"
                            aria-expanded="false" 
                            aria-controls="collapse{{ question.id }}">
                        <strong>{{ forloop.counter }}. {{ question.text }}</strong>
                    </button>
                </h2>
                <div id="collapse{{ question.id }}" 
                     class="accordion-collapse collapse" 
                     data-bs-parent="#accordionQuestions">
                    <div class="accordion-body">
                        <ul class="list-group">
                            {% for choice in question.choices.all %}
                                <li class="list-group-item {% if choice.is_correct %}list-group-item-success{% endif %}">
                                    {{ choice.text }} 
                                    {% if choice.is_correct %}
                                        <span class="badge bg-success">‚úÖ Correct</span>
                                    {% endif %}
                                </li>
                            {% empty %}
                                <li class="list-group-item text-muted">
                                    ‚ö†Ô∏è No options available for this question.
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-info text-center">
            <div style="font-size: 3rem;">üìù</div>
            <h4>No questions yet!</h4>
            <p>This exam doesn't have questions yet.</p>
            {% if user.is_authenticated %}
                <a href="{% url 'question_create' exam.id %}" class="btn btn-primary">
                    ‚ûï Add the first question
                </a>
            {% endif %}
        </div>
    {% endif %}
</div>

<div class="mt-4">
    <a href="{% url 'exam_list' %}" class="btn btn-secondary">
        ‚¨ÖÔ∏è Back to Exams
    </a>
</div>
{% endblock %}